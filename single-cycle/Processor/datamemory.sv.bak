module data_memory(
    input  logic        clk,
    input  logic        MemRead,
    input  logic        MemWrite,
    input  logic [2:0]  funct3,      // identifica lb/lh/lw/lbu/lhu
    input  logic [31:0] addr,
    input  logic [31:0] write_data,
    output logic [31:0] read_data
);

    // 1 KB de memoria simulada (ajusta tamaño según necesites)
    logic [7:0] mem [0:1023];

    // Escritura (sincrónica)
    always_ff @(posedge clk) begin
        if (MemWrite)
            {mem[addr+3], mem[addr+2], mem[addr+1], mem[addr]} <= write_data;
    end

    // Lectura (combinacional)
    always_comb begin
        if (MemRead) begin
            unique case (funct3)
                3'b000: read_data = {{24{mem[addr][7]}}, mem[addr]};                          // LB
                3'b001: read_data = {{16{mem[addr+1][7]}}, mem[addr+1], mem[addr]};          // LH
                3'b010: read_data = {mem[addr+3], mem[addr+2], mem[addr+1], mem[addr]};      // LW
                3'b100: read_data = {24'b0, mem[addr]};                                      // LBU
                3'b101: read_data = {16'b0, mem[addr+1], mem[addr]};                         // LHU
                default: read_data = 32'b0;
            endcase
        end else begin
            read_data = 32'b0;
        end
    end
endmodule
